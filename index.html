<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quiz Buzzer Pro</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">

<style>

body{
background:#0d0d0d;
color:white;
font-family:Nunito;
text-align:center;
}

.title{

font-family:Bebas Neue;
font-size:60px;
color:red;

}

.card{

background:#222;
padding:30px;
border-radius:15px;
display:inline-block;

}

input{

padding:12px;
font-size:18px;

}

button{

padding:15px 30px;
font-size:20px;
margin:10px;
cursor:pointer;

}

#buzzBtn{

background:red;
color:white;

}

#winner{

font-size:40px;
color:gold;
margin-top:20px;

}

</style>

</head>

<body>


<div class="title">BUZZ!</div>


<div id="setup">

<div class="card">

<input id="name" placeholder="Enter Name">

<br>

<button onclick="join()">JOIN</button>

<button onclick="host()">HOST</button>

</div>

</div>



<div id="game" style="display:none">

<button id="buzzBtn" onclick="buzz()">BUZZ</button>

<button onclick="reset()">RESET</button>

<div id="winner"></div>

</div>



<script>


const supabase = window.supabase.createClient(

"https://snayhpmkgnuwyfgzmbpi.supabase.co",

"sb_publishable_TVaiPvD2tRCGMXvfWBhKAg_7CXdSRL4"

);



let myName="";
let isHost=false;
let locked=false;



function join(){

myName=document.getElementById("name").value;

if(!myName){

alert("Enter name");

return;

}

start();

}



function host(){

myName="HOST";

isHost=true;

start();

}



function start(){

document.getElementById("setup").style.display="none";

document.getElementById("game").style.display="block";

listen();

}



async function buzz(){

if(locked)return;

locked=true;

document.getElementById("buzzBtn").disabled=true;



const {data}=await supabase

.from("buzzers")

.select("*")

.limit(1);



if(data.length>0)return;



await supabase

.from("buzzers")

.insert({

name:myName,

time:new Date()

});

}



async function reset(){

if(!isHost){

alert("Only host can reset");

return;

}

locked=false;

document.getElementById("winner").innerHTML="";

document.getElementById("buzzBtn").disabled=false;



await supabase

.from("buzzers")

.delete()

.neq("id",0);

}



function listen(){

supabase

.channel("buzz")

.on(

"postgres_changes",

{

event:"INSERT",

schema:"public",

table:"buzzers"

},

payload=>{

locked=true;

document.getElementById("buzzBtn").disabled=true;

document.getElementById("winner").innerHTML=

"üèÜ "+payload.new.name+" BUZZED FIRST";

}

)

.subscribe();

}



</script>


</body>

</html>
